<!DOCTYPE html>
<html lang="en">
  <head>
    <title> SA Retirement Homes </title>
    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css" rel="stylesheet">
    <style type="text/css">
      html, body, #map-canvas { height: 100%; margin: 0; padding: 0;}
      #map-canvas {width:500px; height:400px;}
      #listPlace {height:100%}
    </style>
    <script src="http://code.jquery.com/jquery-1.11.1.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
    <script type="text/javascript"
      src="https://maps.googleapis.com/maps/api/js?key=AIzaSyAt9NmLDjWl_kQngI0jq0BPA3QUXuMQM_I"></script>
    <script src="js/lib/knockout-3.2.0.js"></script>
  </head>
  <body>
    <div class="container">
        <div class="row" display="inline-flex">
            <h1> San Antonio </h1>
            <div class="col-md-4" id="place-list">
                <ul data-bind="foreach:placeList">
                    <li data-bind="text:name,valueUpdate:$parent.onQuery()">
                    </li>
                </ul>
            </div>
            <div class="col-md-4">
                <form>
                    <input id="search" type="search" name="search" placeholder="Dad's retirement home" data-bind="value: query, valueUpdate: 'keyup'" autocomplete="off" />
                </form>
            </div>

            <div class="col-md-4" id="map-canvas">
            </div>
        </div>
    </div>
    <script type='text/javascript'>

        var Place = function(data) {
            this.name = ko.observable(data.name);
            //this.latLng = ko.observable(data.latLng);
        };

         var initialPlaces = [
            {
                name:'senior care',
                latLng:""
            },
            {
                name:'swimming pool',
                latLng:""
            },
            {
                name:'park',
                latLng:""
            }
        ];

        var ViewModel = function() {
            var self = this;
            this.placeList = ko.observableArray([]);

            initialPlaces.forEach (function(placeEl) {
                self.placeList.push(new Place(placeEl));
            });

            this.query = ko.observable('tierra');

            this.onQuery = function(value) {
                self.placeList.removeAll();

                if (value == '') return;

                for (var place in initialPlaces) {
                    if (initialPlaces[place].name.toLowerCase().indexOf(value.toLowerCase()) >= 0) {
                        self.placeList.push(initialPlaces[place]);
                    }
                };
            };
            self.query.subscribe(self.onQuery);
        };

        function initialize() {
            var myLatLng = new google.maps.LatLng(29.6, -98.5);

            var mapOptions = {
                center: myLatLng,
                zoom: 8,
                scaleControl: true,
                panControl:true
            };
            var map = new google.maps.Map(document.getElementById('map-canvas'),
                mapOptions);

            var marker = new google.maps.Marker({
                position: myLatLng,
                map: map,
                title: 'Hello World!'
            });
        };

        google.maps.event.addDomListener(window, 'load', initialize);


        ko.applyBindings(new ViewModel());
    </script>
  </body>
</html>